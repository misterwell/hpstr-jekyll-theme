<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Hybrid WebApp Test</title>
  </head>
    <body>

    <div class="container">

      <div class="starter-template">
        <h1>Hybrid WebApp Test</h1>
        <p class="lead"><a href="javascript:triggerLoad();">Have JavaScript trigger a <tt>settings-changed</tt> message</a></p>

        <div class="row">
            <div class="col-md-6">
                <p class="lead">Change screen brightness:</p>
                <button type="button" class="btn btn-default btn-lg" onclick="modifyBrightnessLevel(10)">
                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                </button>
                <button type="button" class="btn btn-default btn-lg" onclick="modifyBrightnessLevel(-10)">
                    <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
                </button>
            </div>

            <div class="col-md-6">
                <p class="lead">Idle Timer:</p>
                <div id="myButtons" class="btn-group" data-toggle="buttons">
                  <label class="btn btn-primary active">
                    <input type="radio" name="options" id="true" autocomplete="off" checked">Enabled
                  </label>
                  <label class="btn btn-primary">
                    <input type="radio" name="options" id="false" autocomplete="off">Disabled
                  </label>
                </div>
            </div>
        </div>

      </div>

    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
        <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->

    <script src='https://javascriptbase64.googlecode.com/files/base64.js' type='text/javascript'></script>

    <script>
    var brightness = 100
    var idleDisabled = false
    function getSettingsPayload(brightnessLevel, idleDisabled) {
        var json = {
            "brightnessLevel": brightnessLevel,
            "idleDisabled": idleDisabled
        }
        return Base64.encode(JSON.stringify(json));
    }

    function sendPayload() {
        var payload = getSettingsPayload(brightness, idleDisabled)
        window.open("wework-webdata://" + payload, "_self")
    }

    function triggerLoad() {
        setTimeout(sendPayload, 3000)
    }

    function modifyBrightnessLevel(level) {
        brightness += level
        brightness = (brightness > 100 
                      ? 100 
                      : (brightness < 0 
                         ? 0 
                         : brightness)
                      )
        sendPayload()
    }

    $("#myButtons :input").change(function() {
        modifyIdleDisabled(this.id); // points to the clicked input button
    });

    function modifyIdleDisabled(newSetting) {
        idleDisabled = newSetting
        sendPayload()
    }

    </script>
  </body>
</html>